



<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta http-equiv="last-modified" content="2021-10-18 23:26:16 -0500">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- meta "search-domain" used for google site search function google_search() -->
    <meta name="search-domain" value="">
    <link rel="stylesheet" type="text/css" href="../assets/css/bootstrap.css" />
    <link rel="stylesheet" type="text/css" href="../assets/css/bootstrap-theme.css" />
    <link rel="stylesheet" type="text/css" href="../assets/css/lesson.css" />
    <link rel="stylesheet" type="text/css" href="../assets/css/syntax.css" />

    



    <!-- Favicons for everyone -->
    <link rel="apple-touch-icon-precomposed" sizes="57x57" href="http://localhost:4000/assets/favicons/swc/apple-touch-icon-57x57.png" />
    <link rel="apple-touch-icon-precomposed" sizes="114x114" href="http://localhost:4000/assets/favicons/swc/apple-touch-icon-114x114.png" />
    <link rel="apple-touch-icon-precomposed" sizes="72x72" href="http://localhost:4000/assets/favicons/swc/apple-touch-icon-72x72.png" />
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://localhost:4000/assets/favicons/swc/apple-touch-icon-144x144.png" />
    <link rel="apple-touch-icon-precomposed" sizes="60x60" href="http://localhost:4000/assets/favicons/swc/apple-touch-icon-60x60.png" />
    <link rel="apple-touch-icon-precomposed" sizes="120x120" href="http://localhost:4000/assets/favicons/swc/apple-touch-icon-120x120.png" />
    <link rel="apple-touch-icon-precomposed" sizes="76x76" href="http://localhost:4000/assets/favicons/swc/apple-touch-icon-76x76.png" />
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="http://localhost:4000/assets/favicons/swc/apple-touch-icon-152x152.png" />
    <link rel="icon" type="image/png" href="http://localhost:4000/assets/favicons/swc/favicon-196x196.png" sizes="196x196" />
    <link rel="icon" type="image/png" href="http://localhost:4000/assets/favicons/swc/favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/png" href="http://localhost:4000/assets/favicons/swc/favicon-32x32.png" sizes="32x32" />
    <link rel="icon" type="image/png" href="http://localhost:4000/assets/favicons/swc/favicon-16x16.png" sizes="16x16" />
    <link rel="icon" type="image/png" href="http://localhost:4000/assets/favicons/swc/favicon-128.png" sizes="128x128" />
    <meta name="application-name" content="Software Carpentry - UChicago Tier 3 Batch & Storage"/>
    <meta name="msapplication-TileColor" content="#FFFFFF" />
    <meta name="msapplication-TileImage" content="http://localhost:4000/assets/favicons/swc/mstile-144x144.png" />
    <meta name="msapplication-square70x70logo" content="http://localhost:4000/assets/favicons/swc/mstile-70x70.png" />
    <meta name="msapplication-square150x150logo" content="http://localhost:4000/assets/favicons/swc/mstile-150x150.png" />
    <meta name="msapplication-wide310x150logo" content="http://localhost:4000/assets/favicons/swc/mstile-310x150.png" />
    <meta name="msapplication-square310x310logo" content="http://localhost:4000/assets/favicons/swc/mstile-310x310.png" />


    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
	<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
	<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
	<![endif]-->
    <title>UChicago Tier 3 Batch & Storage: Submitting a Job</title>
  </head>
  <body>

    


<div class="panel panel-default life-cycle">
  <div id="life-cycle" class="panel-body pre-alpha">
    This lesson is still being designed and assembled (Pre-Alpha version)
  </div>
</div>





    <div class="container">
      
<nav class="navbar navbar-default">
  <div class="container-fluid">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      
      
      <a href="https://software-carpentry.org" class="pull-left">
        <img class="navbar-logo" src="../assets/img/swc-icon-blue.svg" alt="Software Carpentry logo" />
      </a>
      

      
      <a class="navbar-brand" href="../index.html">Home</a>

    </div>
    <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
      <ul class="nav navbar-nav">

	
        <li><a href="../CODE_OF_CONDUCT.html">Code of Conduct</a></li>

        
	
        <li><a href="../setup.html">Setup</a></li>

        
        <li class="dropdown">
          <a href="../" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Episodes <span class="caret"></span></a>
          <ul class="dropdown-menu">
            
            <li><a href="../01-introduction/index.html">Introduction</a></li>
            
            <li><a href="../02-htcondor%20quick/index.html">HTCondor Quick Start</a></li>
            
            <li><a href="../03-running_ajob/index.html">Running a Job</a></li>
            
            <li><a href="../04-submitting_ajob/index.html">Submitting a Job</a></li>
            
            <li><a href="../05-coffee/index.html">Coffee break!</a></li>
            
            <li><a href="../06-managing_ajob/index.html">Managing a job</a></li>
            
            <li><a href="../07-services_goodpractices/index.html">Services for Running Jobs</a></li>
            
	    <li role="separator" class="divider"></li>
            <li><a href="../aio/index.html">All in one page (Beta)</a></li>
          </ul>
        </li>
	

	
	
        <li class="dropdown">
          <a href="../" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Extras <span class="caret"></span></a>
          <ul class="dropdown-menu">
            <li><a href="../reference.html">Reference</a></li>
            
          </ul>
        </li>
	

	
        <li><a href="../LICENSE.html">License</a></li>
	
	<li><a href="/edit/gh-pages/_episodes/04-submitting_ajob.md">Improve this page <span class="glyphicon glyphicon-pencil" aria-hidden="true"></span></a></li>
	
      </ul>
      <form class="navbar-form navbar-right" role="search" id="search" onsubmit="google_search(); return false;">
        <div class="form-group">
          <input type="text" id="google-search" placeholder="Search..." aria-label="Google site search">
        </div>
      </form>
    </div>
  </div>
</nav>


<div class="row">
  <div class="col-xs-1">
    <h3 class="text-left">
      
      <a href="../03-running_ajob/index.html"><span class="glyphicon glyphicon-menu-left" aria-hidden="true"></span><span class="sr-only">previous episode</span></a>
      
    </h3>
  </div>
  <div class="col-xs-10">
    
    <h3 class="maintitle"><a href="../">UChicago Tier 3 Batch & Storage</a></h3>
    
  </div>
  <div class="col-xs-1">
    <h3 class="text-right">
      
      <a href="../05-coffee/index.html"><span class="glyphicon glyphicon-menu-right" aria-hidden="true"></span><span class="sr-only">next episode</span></a>
      
    </h3>
  </div>
</div>

<article>
<div class="row">
  <div class="col-md-1">
  </div>
  <div class="col-md-10">
    <h1 class="maintitle">Submitting a Job</h1>
  </div>
  <div class="col-md-1">
  </div>
</div>


<blockquote class="objectives">
  <h2>Overview</h2>

  <div class="row">
    <div class="col-md-3">
      <strong>Teaching:</strong> 10 min
      <br/>
      <strong>Exercises:</strong> 30 min
    </div>
    <div class="col-md-9">
      <strong>Questions</strong>
      <ul>
	
	<li><p>The worst thing about prison was the dementors</p>
</li>
	
	<li><p>Improversation</p>
</li>
	
      </ul>
    </div>
  </div>

  <div class="row">
    <div class="col-md-3">
    </div>
    <div class="col-md-9">
      <strong>Objectives</strong>
      <ul>
	
	<li><p>Retrieve jobs</p>
</li>
	
	<li>
</li>
	
      </ul>
    </div>
  </div>

</blockquote>

<h2 id="submitting-a-job">Submitting a Job</h2>

<p>The <code class="language-plaintext highlighter-rouge">condor_submit</code> command takes a job description file as input and submits the job to HTCondor.  Items such as the name of the executable to run, the initial working directory, and command-line arguments to the program all go into the submit description file. <code class="language-plaintext highlighter-rouge">condor_submit</code> creates a job ClassAd based upon the information, and HTCondor works toward running the job.</p>

<p>It is easy to submit multiple runs of a program to HTCondor with a single submit description file. To run the same program many times with different input data sets, arrange the data files accordingly so that each run reads its own input, and each run writes its own output. Each individual run may have its own initial working directory, files mapped for stdin, stdout, stderr, command-line arguments, and shell environment.</p>

<h2 id="sample-submit-description-files">Sample submit description files</h2>

<h4 id="example-1">Example 1</h4>

<p>This example is one of the simplest submit description files possible. It queues the program myexe for execution somewhere in the pool. As this submit description file does not request a specific operating system to run on, HTCondor will use the default, which is to run the job on a machine which has the same architecture and operating system it was submitted from.</p>

<p>Before submitting a job to HTCondor, it is a good idea to test it first locally, by running it from a command shell. This example job might look like this when run from the shell prompt.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>./myexe SomeArgument
</code></pre></div></div>
<p>The corresponding submit description file might look like the following</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Example 1</span>
<span class="c"># Simple HTCondor submit description file</span>
<span class="c"># Everything with a leading # is a comment</span>

executable   <span class="o">=</span> myexe
arguments    <span class="o">=</span> SomeArgument

output       <span class="o">=</span> outputfile   
error        <span class="o">=</span> errorfile
log          <span class="o">=</span> myexe.log

request_cpus   <span class="o">=</span> 1
request_memory <span class="o">=</span> 1024
request_disk   <span class="o">=</span> 10240

should_transfer_files <span class="o">=</span> <span class="nb">yes

</span>queue
</code></pre></div></div>

<blockquote class="callout">
  <h2 id="explanation-of-variables-in-example-1">Explanation of variables in example 1</h2>

  <p>output        :   The standard output for this job will go to the file <code class="language-plaintext highlighter-rouge">outputfile</code>.</p>

  <p>error :  The standard error output will go to <code class="language-plaintext highlighter-rouge">errorfile</code>.</p>

  <p>log :    Appended evenst about the job to the log file named <code class="language-plaintext highlighter-rouge">myexe.log</code>.</p>

  <p>request_cpus  :   The job should be allocated 1 cpu core.</p>

  <p>request_memory:   1024 megabytes of memory.</p>

  <p>request_disk  :   10240 kilobytes of scratch disk space.</p>

  <p>queue         :   Hey HTCondor! I’ve finished the description of the job, send it to the queue.</p>

</blockquote>

<h4 id="example-2">Example 2</h4>

<p>The submit description file for this example queues 150 runs of program foo.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># Example 2: Show off some fancy features,</span>
<span class="c"># including the use of pre-defined macros.</span>

executable     <span class="o">=</span> foo
arguments      <span class="o">=</span> input_file.<span class="si">$(</span>Process<span class="si">)</span>

request_memory <span class="o">=</span> 4096
request_cpus   <span class="o">=</span> 1
request_disk   <span class="o">=</span> 16383

error   <span class="o">=</span> err.<span class="si">$(</span>Process<span class="si">)</span>
output  <span class="o">=</span> out.<span class="si">$(</span>Process<span class="si">)</span>
log     <span class="o">=</span> foo.log

should_transfer_files <span class="o">=</span> <span class="nb">yes
</span>transfer_input_files <span class="o">=</span> input_file.<span class="si">$(</span>Process<span class="si">)</span>

<span class="c"># submit 150 instances of this job</span>
queue 150
</code></pre></div></div>

<p>Each instance of this program works on one input file. 
We prepare 150 copies of this input file in the current directoy, and name them input_file.0, … up to input_file.149. 
Whit transfer_input_files, we tell HTCondor which input file to send to each instance of the program.</p>

<h2 id="submitting-many-similar-jobs-with-one-queue-command">Submitting many similar jobs with one queue command</h2>

<p>A wide variety of job submissions can be specified with extra information to the queue submit command. This flexibility eliminates the need for a job wrapper or Perl script for many submissions.</p>

<p>The form of the queue command defines variables and expands values, identifying a set of jobs. Square brackets identify an optional item.</p>

<p>queue [&lt; int expr &gt; ]</p>

<p>queue [&lt; int expr &gt; ] [&lt; varname &gt; ] in [slice ] &lt; list of items &gt;</p>

<table>
  <tbody>
    <tr>
      <td>queue [&lt; int expr &gt; ] [&lt; varname &gt; ] matching [files</td>
      <td>dirs ] [slice ] &lt; list of items with file globbing &gt;</td>
    </tr>
  </tbody>
</table>

<table>
  <tbody>
    <tr>
      <td>queue [&lt; int expr &gt; ] [&lt; list of varnames &gt; ] from [slice ] &lt; file name &gt;</td>
      <td>&lt; list of items &gt;</td>
    </tr>
  </tbody>
</table>

<p>All optional items have defaults:</p>

<ul>
  <li>
    <p>If &lt; int expr &gt; is not specified, it defaults to the value 1.</p>
  </li>
  <li>
    <p>If &lt; varname &gt; or &lt; list of varnames &gt; is not specified, it defaults to the single variable called ITEM.</p>
  </li>
  <li>
    <p>If slice is not specified, it defaults to all elements within the list. This is the Python slice [::], with a step value of 1.</p>
  </li>
  <li>
    <p>If neither files nor dirs is specified in a specification using the from key word, then both files and directories are considered when globbing.</p>
  </li>
</ul>

<table>
  <tbody>
    <tr>
      <td>The list of items uses syntax in one of two forms. One form is a comma and/or space separated list; the items are placed on the same line as the queue command. The second form separates items by placing each list item on its own line, and delimits the list with parentheses. The opening parenthesis goes on the same line as the queue command. The closing parenthesis goes on its own line. The queue command specified with the key word from will always use the second form of this syntax. Example 3 below uses this second form of syntax. Finally, the key word from accepts a shell command in place of file name, followed by a pipe</td>
      <td>(example 4).</td>
    </tr>
  </tbody>
</table>

<p>The optional slice specifies a subset of the list of items using the Python syntax for a slice. Negative step values are not permitted.</p>

<p>Here are a set of examples.</p>

<h3 id="example-1-1">Example 1</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>transfer_input_files <span class="o">=</span> <span class="si">$(</span>filename<span class="si">)</span>
arguments            <span class="o">=</span> <span class="nt">-infile</span> <span class="si">$(</span>filename<span class="si">)</span>
queue filename matching files <span class="k">*</span>.dat
</code></pre></div></div>

<p>The use of file globbing expands the list of items to be all files in the current directory that end in .dat. Only files, and not directories are considered due to the specification of files. One job is queued for each file in the list of items. For this example, assume that the three files initial.dat, middle.dat, and ending.dat form the list of items after expansion; macro filename is assigned the value of one of these file names for each job queued. That macro value is then substituted into the arguments and transfer_input_files commands. The queue command expands to</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>transfer_input_files = initial.dat
arguments            = -infile initial.dat
queue
transfer_input_files = middle.dat
arguments            = -infile middle.dat
queue
transfer_input_files = ending.dat
arguments            = -infile ending.dat
queue
</code></pre></div></div>

<p>### Example 2</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>queue 1 input <span class="k">in </span>A, B, C
</code></pre></div></div>

<p>Variable input is set to each of the 3 items in the list, and one job is queued for each. For this example the queue command expands to</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>input <span class="o">=</span> A
queue
input <span class="o">=</span> B
queue
input <span class="o">=</span> C
queue
</code></pre></div></div>

<p>Example 3</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>queue input, arguments from <span class="o">(</span>
  file1, <span class="nt">-a</span> <span class="nt">-b</span> 26
  file2, <span class="nt">-c</span> <span class="nt">-d</span> 92
<span class="o">)</span>
</code></pre></div></div>
<p>Using the from form of the options, each of the two variables specified is given a value from the list of items. For this example the queue command expands to</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>input <span class="o">=</span> file1
arguments <span class="o">=</span> <span class="nt">-a</span> <span class="nt">-b</span> 26
queue
input <span class="o">=</span> file2
arguments <span class="o">=</span> <span class="nt">-c</span> <span class="nt">-d</span> 92
queue
</code></pre></div></div>

<p>## Example 4</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>queue from <span class="nb">seq </span>7 9 |
</code></pre></div></div>

<p>feeds the list of items to queue with the output of seq 7 9:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>item <span class="o">=</span> 7
queue
item <span class="o">=</span> 8
queue
item <span class="o">=</span> 9
queue
</code></pre></div></div>
<h2 id="including-submit-commands-defined-elsewhere">Including Submit Commands Defined Elsewhere</h2>

<p>Externally defined submit commands can be incorporated into the submit description file using the syntax</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>include : &lt;what-to-include&gt;
</code></pre></div></div>

<p>The <what-to-include> specification may specify a single file, where the contents of the file will be incorporated into the submit description file at the point within the file where the include is. Or, <what-to-include> may cause a program to be executed, where the output of the program is incorporated into the submit description file. The specification of <what-to-include> has the bar character (|) following the name of the program to be executed.</what-to-include></what-to-include></what-to-include></p>

<p>The include key word is case insensitive. There are no requirements for white space characters surrounding the colon character.</p>

<p>Included submit commands may contain further nested include specifications, which are also parsed, evaluated, and incorporated. Levels of nesting on included files are limited, such that infinite nesting is discovered and thwarted, while still permitting nesting.</p>

<p>Consider the example</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>include : ./list-infiles.sh |
</code></pre></div></div>

<p>In this example, the bar character at the end of the line causes the script list-infiles.sh to be invoked, and the output of the script is parsed and incorporated into the submit description file. If this bash script is in the PATH when submit is run, and contains</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/bin/sh</span>

<span class="nb">echo</span> <span class="s2">"transfer_input_files = </span><span class="sb">`</span><span class="nb">ls</span> <span class="nt">-m</span> infiles/<span class="k">*</span>.dat<span class="sb">`</span><span class="s2">"</span>
<span class="nb">exit </span>0
</code></pre></div></div>

<p>then the output of this script has specified the set of input files to transfer to the execute host. For example, if directory infiles contains the three files A.dat, B.dat, and C.dat, then the submit command</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>transfer_input_files <span class="o">=</span> infiles/A.dat, infiles/B.dat, infiles/C.dat
</code></pre></div></div>

<p>is incorporated into the submit description file.</p>

<h2 id="using-conditionals-in-the-submit-description-file">Using Conditionals in the Submit Description File</h2>

<p>Conditional if/else semantics are available in a limited form. The syntax:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if</span> &lt;simple condition&gt;
   &lt;statement&gt;
   <span class="nb">.</span> <span class="nb">.</span> <span class="nb">.</span>
   &lt;statement&gt;
<span class="k">else</span>
   &lt;statement&gt;
   <span class="nb">.</span> <span class="nb">.</span> <span class="nb">.</span>
   &lt;statement&gt;
endif
</code></pre></div></div>

<p>An else key word and statements are not required, such that simple if semantics are implemented. The <simple condition=""> does not permit compound conditions. It optionally contains the exclamation point character (!) to represent the not operation, followed by</simple></p>

<ul>
  <li>the defined keyword followed by the name of a variable. If the variable is defined, the statement(s) are incorporated into the expanded input. If the variable is not defined, the statement(s) are not incorporated into the expanded input. As an example,</li>
</ul>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    <span class="k">if </span>defined MY_UNDEFINED_VARIABLE
       X <span class="o">=</span> 12
    <span class="k">else
       </span>X <span class="o">=</span> <span class="nt">-1</span>
    endif
</code></pre></div></div>

<p>results in X = -1, when MY_UNDEFINED_VARIABLE is not yet defined.</p>

<ul>
  <li>
    <p>the version keyword, representing the version number of of the daemon or tool currently reading this conditional. This keyword is followed by an HTCondor version number. That version number can be of the form x.y.z or x.y. The version of the daemon or tool is compared to the specified version number. The comparison operators are</p>

    <ul>
      <li>
        <p>’==’ for equality. Current version 8.2.3 is equal to 8.2.</p>
      </li>
      <li>
        <p>’&gt;=’ to see if the current version number is greater than or equal to. Current version 8.2.3 is greater than 8.2.2, and current version 8.2.3 is greater than or equal to 8.2.</p>
      </li>
      <li>
        <p>’&lt;=’ to see if the current version number is less than or equal to. Current version 8.2.0 is less than 8.2.2, and current version 8.2.3 is less than or equal to 8.2.</p>
      </li>
    </ul>

    <p>As an example,</p>

    <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  <span class="k">if </span>version <span class="o">&gt;=</span> 8.1.6
     DO_X <span class="o">=</span> True
  <span class="k">else
     </span>DO_Y <span class="o">=</span> True
  endif
</code></pre></div>    </div>

    <p>results in defining DO_X as True if the current version of the daemon or tool reading this if statement is 8.1.6 or a more recent version.</p>

    <ul>
      <li>
        <p>True or yes or the value 1. The statement(s) are incorporated.</p>
      </li>
      <li>
        <p>False or no or the value 0 The statement(s) are not incorporated.</p>
      </li>
      <li>
        <p>$(<variable>) may be used where the immediately evaluated value is a simple boolean value. A value that evaluates to the empty string is considered False, otherwise a value that does not evaluate to a simple boolean value is a syntax error.</variable></p>
      </li>
    </ul>
  </li>
</ul>

<p>The syntax</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if</span> &lt;simple condition&gt;
   &lt;statement&gt;
   <span class="nb">.</span> <span class="nb">.</span> <span class="nb">.</span>
   &lt;statement&gt;
<span class="k">elif</span> &lt;simple condition&gt;
   &lt;statement&gt;
   <span class="nb">.</span> <span class="nb">.</span> <span class="nb">.</span>
   &lt;statement&gt;
endif
</code></pre></div></div>

<p>is the same as syntax</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if</span> &lt;simple condition&gt;
   &lt;statement&gt;
   <span class="nb">.</span> <span class="nb">.</span> <span class="nb">.</span>
   &lt;statement&gt;
<span class="k">else
   if</span> &lt;simple condition&gt;
      &lt;statement&gt;
      <span class="nb">.</span> <span class="nb">.</span> <span class="nb">.</span>
      &lt;statement&gt;
   endif
endif
</code></pre></div></div>

<p>Here is an example use of a conditional in the submit description file. A portion of the sample.sub submit description file uses the if/else syntax to define command line arguments in one of two ways:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if </span>defined X
  arguments <span class="o">=</span> <span class="nt">-n</span> <span class="si">$(</span>X<span class="si">)</span>
<span class="k">else
  </span>arguments <span class="o">=</span> <span class="nt">-n</span> 1 <span class="nt">-debug</span>
endif
</code></pre></div></div>

<p>Submit variable X is defined on the condor_submit command line with</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>condor_submit  <span class="nv">X</span><span class="o">=</span>3  sample.sub
</code></pre></div></div>

<p>This command line incorporates the submit command X = 3 into the submission before parsing the submit description file. For this submission, the command line arguments of the submitted job become</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>arguments <span class="o">=</span> <span class="nt">-n</span> 3
</code></pre></div></div>

<p>If the job were instead submitted with the command line</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>condor_submit  sample.sub
</code></pre></div></div>

<p>then the command line arguments of the submitted job become</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>arguments = -n 1 -debug
</code></pre></div></div>

<p>## Interactive Jobs</p>

<p>An interactive job is a Condor job that is provisioned and scheduled like any other vanilla universe Condor job onto an execute machine within the pool. The result of a running interactive job is a shell prompt issued on the execute machine where the job runs. The user that submitted the interactive job may then use the shell as desired, perhaps to interactively run an instance of what is to become a Condor job. This might aid in checking that the set up and execution environment are correct, or it might provide information on the RAM or disk space needed. This job (shell) continues until the user logs out or any other policy implementation causes the job to stop running. A useful feature of the interactive job is that the users and jobs are accounted for within Condor’s scheduling and priority system.</p>

<p>Neither the submit nor the execute host for interactive jobs may be on Windows platforms.</p>

<p>The current working directory of the shell will be the initial working directory of the running job. The shell type will be the default for the user that submits the job. At the shell prompt, X11 forwarding is enabled.</p>

<p>Each interactive job will have a job ClassAd attribute of</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>InteractiveJob <span class="o">=</span> True
</code></pre></div></div>

<p>Submission of an interactive job specifies the option -interactive on the condor_submit command line.</p>

<p>A submit description file may be specified for this interactive job. Within this submit description file, a specification of these 5 commands will be either ignored or altered:</p>

<ol>
  <li>
    <p>executable</p>
  </li>
  <li>
    <p>transfer_executable</p>
  </li>
  <li>
    <p>arguments</p>
  </li>
  <li>
    <p>universe . The interactive job is a vanilla universe job.</p>
  </li>
  <li>
    <p>queue <n>. In this case the value of <n> is ignored; exactly one interactive job is queued.</n></n></p>
  </li>
</ol>

<p>The submit description file may specify anything else needed for the interactive job, such as files to transfer.</p>

<p>If no submit description file is specified for the job, a default one is utilized as identified by the value of the configuration variable INTERACTIVE_SUBMIT_FILE .</p>

<p>Here are examples of situations where interactive jobs may be of benefit.</p>

<ul>
  <li>
    <p>An application that cannot be batch processed might be run as an interactive job. Where input or output cannot be captured in a file and the executable may not be modified, the interactive nature of the job may still be run on a pool machine, and within the purview of Condor.</p>
  </li>
  <li>
    <p>A pool machine with specialized hardware that requires interactive handling can be scheduled with an interactive job that utilizes the hardware.</p>
  </li>
  <li>
    <p>The debugging and set up of complex jobs or environments may benefit from an interactive session. This interactive session provides the opportunity to run scripts or applications, and as errors are identified, they can be corrected on the spot.</p>
  </li>
  <li>
    <p>Development may have an interactive nature, and proceed more quickly when done on a pool machine. It may also be that the development platforms required reside within Condor’s purview as execute hosts.</p>
  </li>
</ul>

<h2 id="submitting-lots-of-jobs">Submitting Lots of Jobs</h2>

<p>When submitting a lot of jobs with a single submit file, you can dramatically speed up submission and reduce the load on the condor_schedd by submitting the jobs as a late materialization job factory.</p>

<p>A submission of this form sends a single ClassAd, called the Cluster ad, to the condor_schedd, as well as instructions to create the individual jobs as variations on that Cluster ad. These instructions are sent as a submit digest and optional itemdata. The submit digest is the submit file stripped down to just the statements that vary between jobs. The itemdata is the arguments to the Queue statement when the arguments are more than just a count of jobs.</p>

<p>The condor_schedd will use the submit digest and the itemdata to create the individual job ClassAds when they are needed. Materialization is controlled by two values stored in the Cluster classad, and by optional limits configured in the condor_schedd.</p>

<p>The max_idle limit specifies the maximum number of non-running jobs that should be materialized in the condor_schedd at any one time. One or more jobs will materialize whenever a job enters the Run state and the number of non-running jobs that are still in the condor_schedd is less than this limit. This limit is stored in the Cluster ad in the JobMaterializeMaxIdle attribute.</p>

<p>The max_materialize limit specifies an overall limit on the number of jobs that can be materialized in the condor_schedd at any one time. One or more jobs will materialize when a job leaves the condor_schedd and the number of materialized jobs remaining is less than this limit. This limit is stored in the Cluster ad in the JobMaterializeLimit attribute.</p>

<p>Late materialization can be used as a way for a user to submit millions of jobs without hitting the MAX_JOBS_PER_OWNER or MAX_JOBS_PER_SUBMISSION limits in the condor_schedd, since the condor_schedd will enforce these limits by applying them to the max_materialize and max_idle values specified in the Cluster ad.</p>

<p>To give an example, the following submit file:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>executable     <span class="o">=</span> foo
arguments      <span class="o">=</span> input_file.<span class="si">$(</span>Process<span class="si">)</span>

request_memory <span class="o">=</span> 4096
request_cpus   <span class="o">=</span> 1
request_disk   <span class="o">=</span> 16383

error   <span class="o">=</span> err.<span class="si">$(</span>Process<span class="si">)</span>
output  <span class="o">=</span> out.<span class="si">$(</span>Process<span class="si">)</span>
log     <span class="o">=</span> foo.log

should_transfer_files <span class="o">=</span> <span class="nb">yes
</span>transfer_input_files <span class="o">=</span> input_file.<span class="si">$(</span>Process<span class="si">)</span>

<span class="c"># submit as a factory with an idle jobs limit</span>
max_idle <span class="o">=</span> 100

<span class="c"># submit 15,000 instances of this job</span>
queue 15<span class="k">*</span>1000
</code></pre></div></div>

<p>When submitted as a late materialization factory, the submit digest for this factory will contain only the submit statments that vary between jobs, and the collapsed queue statement like this:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>arguments <span class="o">=</span> input_file.<span class="si">$(</span>Process<span class="si">)</span>
error <span class="o">=</span> err.<span class="si">$(</span>Process<span class="si">)</span>
output <span class="o">=</span> out.<span class="si">$(</span>Process<span class="si">)</span>
transfer_input_files <span class="o">=</span> input_file.<span class="si">$(</span>Process<span class="si">)</span>

queue 15000
</code></pre></div></div>



<blockquote class="keypoints">
  <h2>Key Points</h2>
  <ul>
    
    <li><p>y</p>
</li>
    
    <li>
</li>
    
  </ul>
</blockquote>

</article>

<div class="row">
  <div class="col-xs-1">
    <h3 class="text-left">
      
      <a href="../03-running_ajob/index.html"><span class="glyphicon glyphicon-menu-left" aria-hidden="true"></span><span class="sr-only">previous episode</span></a>
      
    </h3>
  </div>
  <div class="col-xs-10">
    
  </div>
  <div class="col-xs-1">
    <h3 class="text-right">
      
      <a href="../05-coffee/index.html"><span class="glyphicon glyphicon-menu-right" aria-hidden="true"></span><span class="sr-only">next episode</span></a>
      
    </h3>
  </div>
</div>


      
      
<footer>
  <div class="row">
    <div class="col-md-6 copyright" align="left">
	
	Licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC-BY 4.0</a> 2018–2021
	by <a href="https://carpentries.org/">The Carpentries</a>
        <br>
        Licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC-BY 4.0</a> 2016–2018
	by <a href="https://software-carpentry.org">Software Carpentry Foundation</a>
	
    </div>
    <div class="col-md-6 help-links" align="right">
	
	<a href="/edit/gh-pages/_episodes/04-submitting_ajob.md">Edit on GitHub</a>
	
	/
	<a href="/blob/gh-pages/CONTRIBUTING.md">Contributing</a>
	/
	<a href="/">Source</a>
	/
	<a href="/blob/gh-pages/CITATION">Cite</a>
	/
	<a href="mailto:duranmcecilia@gmail.com">Contact</a>
    </div>
  </div>
  <div class="row">
    <div class="col-md-12" align="center">
      Using <a href="https://github.com/carpentries/styles/">The Carpentries style</a>
      version <a href="https://github.com/carpentries/styles/releases/tag/v9.5.3">9.5.3</a>.
    </div>
  </div>
</footer>

      
    </div>
    
<script src="../assets/js/jquery.min.js"></script>
<script src="../assets/js/bootstrap.min.js"></script>
<script src="../assets/js/lesson.js"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-37305346-2', 'auto');
  ga('send', 'pageview');
</script>

  </body>
</html>
